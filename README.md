# Chatbot-support

Бот принимает от пользователя описание бага игры, который тот нашел,
и отправляет его через почту на сайт freshdesk.com.



## Как получить API-ключ от Телеграм

* Cкачать приложение под вашу операционную систему. https://telegram.org/
* Создать аккаунт
* В поиск и набираем "BotFather" или по ссылке @BotFather. И нажимаем в открывшемся чате "START"
* выбираем команду "/newbot" или находим ее в "Menu" внизу.
* Устанавливаем имя (дальше можно будет изменить его)
* Устанавливаем username - уникальное имя, которое нельзя будет менять,
  и которое обязательно должно оканчиваться на "bot".
* Получаем токен, API-ключ от блота

## Как настроить бота

Для работы бота необходимо переделать файл .env.example в .env, предварительно изменив в нем данные на действительные
(все данные вставляются в кавычках):

* BOT_TOKEN - необходимо вставить токен бота
* sender_email - написать почту с которой бот будет отправлять репорты (на данный момент опробована только yandex)
* sender_password - пароль от предыдущей почты
* recipient_email - почта freshdesk.com куда будут уходить сообщения

## Возможности и функции

- Функция 1: После нажатия пользователем кнопки "start", бот запоминает язык настройки телеграмм пользователя
  и начинает с ним общаться на его языке. На данный момент это либо RU - Русский либо любой другой - English.
  Язык (необходимые фразы) возможно добавить по аналогии в файл [data.json](chatbot_support/data.json) и они автоматически подключатся.
- Функция 2: На первом шаге бот предлагает пользователю посетить оф. страницу. Ее можно сменить в [data.json](chatbot_support/data.json)
- Функция 3: На шаге ввода электронной почты действует регулярное выражение на валидность. Его можно сменить
  в [data.json](chatbot_support/data.json)
- Функция 4: На шаге ввода игры бот предлагает выбрать ее из предоставляемого списка. Его можно сменить
  в [data.json](chatbot_support/data.json)
- Функция 5: Бот позволяет отправлять только по 1 репорту в 10 минут. О чем предупреждает юзера после первой отправки.

## Установка и запуск телеграм-бота на AWS EC2 удаленно:

1. Создайте экземпляр Amazon EC2:
Войдите в консоль AWS.
Перейдите в раздел "EC2".
Щелкните "Launch Instance" и выберите ОС и конфигурацию экземпляра.
2. Настройте экземпляр:
Во время создания экземпляра, убедитесь, что у вас есть правильные ключи и группы безопасности для доступа к экземпляру.
3. Загрузите свой бот на экземпляр с помощью **filezilla**:
* Убедитесь, что у вашего EC2-инстанса есть правило безопасности (Security Group) с открытым портом для SFTP (порт 22 для SFTP или 21 для FTP). Если нет, создайте правило с нужными портами.
* Получите публичный DNS или IP-адрес вашего EC2-инстанса: Зайдите в AWS Management Console, перейдите в раздел EC2, выберите ваш экземпляр и найдите публичный DNS или IP-адрес.
* Запустите FileZilla на вашем компьютере.
* В верхней части FileZilla введите данные для подключения:
** **Хост (Host)**: Публичный DNS или IP-адрес вашего EC2-инстанса.
** **Порт (Port)**: Оставьте пустым для SFTP (22) или введите 21 для FTP.
** **Протокол (Protocol)**: Выберите SFTP для защищенного подключения.
** **Тип входа (Logon Type)**: Выберите "Normal".
** **Имя пользователя (User)**: Введите имя пользователя, которое вы используете для подключения к EC2 (например, "ec2-user" или "ubuntu").
** **Пароль (Password)**: Если вы используете ключи для аутентификации, оставьте поле пустым. В противном случае, введите пароль.
* Нажмите кнопку **"Quickconnect"**:
* После успешного подключения, вы увидите список файлов и папок на вашем EC2-инстансе в правой части FileZilla.
Теперь вы можете управлять файлами на вашем EC2-инстансе через FileZilla. 
Обратите внимание, что для безопасности лучше использовать ключи SSH для аутентификации вместо паролей.
4. Подключитесь к экземпляру по SSH (в консоли или терминале):
Используйте команду ssh для подключения к экземпляру с использованием ключа доступа: 
**ssh -i "/path/to/your-key.pem" ec2-user@your-instance-public-dns**
Замените **/path/to/your-key.pem** на путь к вашему ключу и **your-instance-public-dns** на публичный DNS вашего экземпляра.
5. Установка Python и Зависимостей:
Установите Python: **sudo yum install python3** (замените yum на apt для Ubuntu)
Установите pip: **sudo yum install python3-pip** (замените yum на apt для Ubuntu)
установка библиотек: **sudo pip install -r requirements.txt**
6. Перейдите в директорию с запускаемым файлом с помощью команды **cd "имя_папки"**
7. Запустите бота в фоновом режиме с использованием: **nohup python my_bot.py > bot.log 2>&1 &**
с перенаправлением ошибок и стандартного вывода в файл bot.log (создатся самостоятельно)
8. Можно выйти из консоли (терминала)
9. Для остановки работы бота воспользуйтесь командой **kill "ID процесса"**. 
ID дается при запуске, так же его можно узнать командой 
**pgrep -af ИмяБота.py**

## Часто задаваемые вопросы (FAQ)

...

## Контактная информация

MemphisAton@gmail.com

